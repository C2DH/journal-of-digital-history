{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "https://journaldigitalhistory.eu/schemas/abstract.json",
  "type": "object",
  "title": "Abstract Submission Schema",
  "description": "Schema to validate abstract submissions",
  "required": ["title", "abstract", "datasets", "contact", "authors", "acceptConditions"],
  "properties": {
    "title": {
      "$ref": "#/definitions/title"
    },
    "abstract": {
      "$ref": "#/definitions/abstract"
    },
    "datasets": {
      "type": "array",
      "minItems": 0,
      "maxItems": 10,
      "items": {
        "type": "object",
        "required": ["url", "description"],
        "properties": {
          "url": {
            "$ref": "#/definitions/url"
          },
          "description": {
            "$ref": "#/definitions/text500"
          },
          "type": {
            "$ref": "#/definitions/text250"
          },
          "license": {
            "$ref": "#/definitions/text250"
          }
        },
        "errorMessage": {
          "required": {
            "url": "Dataset URL is required",
            "description": "Dataset description is required"
          }
        }
      },
      "errorMessage": {
        "type": "Datasets must be an array",
        "maxItems": "No more than 10 datasets are allowed."
      }
    },
    "contact": {
      "type": "object",
      "required": ["firstname", "lastname", "affiliation", "email", "orcid", "githubId"],
      "properties": {
        "firstname": {
          "$ref": "#/definitions/firstname"
        },
        "lastname": {
          "$ref": "#/definitions/lastname"
        },
        "affiliation": {
          "$ref": "#/definitions/affiliation"
        },
        "email": {
          "$ref": "#/definitions/email"
        },
        "orcid": {
          "$ref": "#/definitions/orcid"
        },
        "githubId": {
          "$ref": "#/definitions/githubId"
        }
      },
      "errorMessage": {
        "required": {
          "githubId": "Please provide a valid <em>GitHub username</em>"
        }
      }
    },
    "authors": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["firstname", "lastname", "affiliation", "email",  "orcid"],
        "properties": {
          "firstname": {
            "$ref": "#/definitions/firstname"
          },
          "lastname": {
            "$ref": "#/definitions/lastname"
          },
          "affiliation": {
            "$ref": "#/definitions/affiliation"
          },
          "email": {
            "$ref": "#/definitions/email"
          },
          "orcid": {
            "$ref": "#/definitions/orcid"
          }
        }
      },
      "errorMessage": {
        "type": "Authors must be an array.",
        "minItems": "At least <em>one contributor</em> is required"
      }
    },
    "githubId": {
      "$ref": "#/definitions/githubId"
    },
    "acceptConditions": {
      "$ref": "#/definitions/acceptConditions"
    },
    "callForPapers": {
      "$ref": "#/definitions/callForPapers"
    },
    "token": {
      "$ref": "#/definitions/token"
    }
  },
  "definitions": {
    "title": {
      "$id": "#/definitions/title",
      "type": "string",
      "minLength": 10,
      "maxLength": 250,
      "errorMessage": {
        "type": "Title must be a string",
        "minLength": "Title must be at least 10 characters long",
        "maxLength": "Title must not exceed 250 characters"
      }
    },
    "abstract": {
      "$id": "#/definitions/abstract",
      "type": "string",
      "minLength": 100,
      "maxLength": 10000,
      "errorMessage": {
        "type": "Abstract must be a string",
        "minLength": "Abstract must be at least 100 characters long",
        "maxLength": "Abstract must not exceed 10,000 characters"
      }
    },
    "text250": {
      "$id": "#/definitions/text250",
      "type": "string",
      "maxLength": 250,
      "errorMessage": {
        "minLength": "A <b>description</b> is required to add a valid \"Tools, Code & Data\" item",
        "maxLength": "Description must not exceed 250 characters"
      }
    },
    "text500": {
      "$id": "#/definitions/text500",
      "type": "string",
      "maxLength": 500,
      "errorMessage": {
        "maxLength": "Description must not exceed 500 characters"
      }
    },
    "url": {
      "$id": "#/definitions/url",
      "type": "string",
      "format": "uri",
      "maxLength": 500,
      "errorMessage": {
        "type": "Dataset URL must be a string",
        "format": "One <b>URL</b> in <b> \"Tools, Code & Data\"</b> is not valid, make sure it starts with <code>http</code>",
        "maxLength": "Dataset URL must not exceed 500 characters"
      }
    },
    "firstname": {
      "$id": "#/definitions/firstname",
      "type": "string",
      "maxLength": 100,
      "errorMessage": {
        "minLength": "First name must be filled",
        "maxLength": "First name must not exceed 100 characters"
      }
    },
    "lastname": {
      "$id": "#/definitions/lastname",
      "type": "string",
      "maxLength": 100,
      "errorMessage": {
        "minLength": "Last name must be filled",
        "maxLength": "Last name must not exceed 100 characters"
      }
    },
    "email": {
      "$id": "#/definitions/email",
      "type": "string",
      "format": "email",
      "errorMessage": {
        "format": "Email must be a valid email address, like <em>mail@example.com</em>"
      }
    },
    "orcid": {
      "$id": "#/definitions/orcid",
      "type": "string",
      "pattern": "^https?://orcid.org/[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9X]{4}$",
      "errorMessage": {
        "pattern": "An ORCID url is required as <em>https://orcid.org/0000-0000-0000-0000</em>"
      }
    },
    "githubId": {
      "$id": "#/definitions/githubId",
      "type": "string",
      "pattern": "^(?!-)(?!.*--)[a-z0-9-]{1,39}(?<!-)$",
      "minLength": 1,
      "maxLength": 39,
      "errorMessage": {
        "type": "A valid githubId is required",
        "pattern": "A valid githubId is required",
        "minLength": "A valid githubId is required",
        "maxLength": "A valid githubId does not exceed 39 characters"
      }
    },
    "affiliation": {
      "$id": "#/definitions/affiliation",
      "type": "string",
      "maxLength": 250
    },
    "token": {
      "$id": "#/definitions/token",
      "type": "string",
      "maxLength": 1000
    },
    "acceptConditions": {
      "$id": "#/definitions/acceptConditions",
      "type": "boolean",
      "enum": [true],
      "errorMessage": {
        "enum": "... and don't forget to check the <b>terms and conditions</b>."
      }
    },
    "callForPapers": {
      "$id": "#/definitions/callForPapers",
      "type": "string",
      "pattern": "^[0-9a-zA-Z-]*$",
      "minLength": 0,
      "maxLength": 100
    }
  }
}